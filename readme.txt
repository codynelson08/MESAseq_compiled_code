Updated 22 May 2019

1) System requirements
All code tested and executed using R (version 3.5.1) in RStudio (version 1.1.456) in MacOS Mojave (version 10.14.2). No non-standard hardware required. 

2) Installation guide
Install R here: https://cran.rstudio.com/
and RStudio here: https://www.rstudio.com/products/rstudio/download/

3) Demo and 4) Instructions for use
We have included all code to complete analyses detailed in manuscript, separated into folders by figure/table (see details for each folder below). Source data is available in a separate folder labeled ‘source data files.’ 

*Figures 1, S1, S2, S3 and Tables 1, 2 were generated without code using a combination of Prism graphpad, microsoft office excel, and microsoft office powerpoint

Figure 2:
-2A made using Prism graphpad. 
-2B generated by running ‘haplotype_presence_over_time_csp.R’ using ‘csp_haps_demog_merged_nocontrols.csv’

Figure 3:
-3A-C generated by running ‘plot map.R’ using sequences from ‘CSP_unique_seqs.fasta’ and coordinates from ‘csp_allhaps_demog_person_age_decimaldate_latlong.csv’
-3D generated by running ‘create_network_for_daterange.R’ using ‘csp_allhaps_demog_person.csv’ 
-3E-F generated running ‘binary sharing all month comparison csp.R’ or proportional sharing and L1 norm equivalents using files ‘csp_allhaps_demog_person.csv’ and ‘csp_months.csv’
-3G-I generated running ‘binary sharing all location comparison csp.R’ or proportional sharing and L1 norm equivalents using files ‘csp_allhaps_demog_person.csv’ and ‘csp_locations.csv’. 2013 and 2014 designations made by modifying year in initial nested for loop structure

Figure 4:
-Household matching csp completed using ‘household matching csp temporal_weighted.R’ with ‘csp_allhaps_demog_person_age_decimaldate.csv' and 'csp_case_households.csv’. ama1 metrics using ama1 equivalents.
-Origin household sharing csp completed using ‘binary sharing origin households case_child csp” or proportional sharing and L1 norm equivalents with ‘csp_case_households.csv’ and ‘csp_allhaps_demog_person.csv’ . ama1 metrics using ama1 equivalents. 
-Matched household sharing csp completed using ‘binary sharing match households case_child csp” or proportional sharing and L1 norm equivalents with ‘csp_matched_households.csv’ and ‘csp_allhaps_demog_person.csv’. ama1 metrics using ama1 equivalents. 
-Figure constructed using Prism graphpad

Figure 5:
-Pairwise similarity calculations csp completed using ‘binary sharing all case_child comparisons time list csp.R’ with ‘csp_allhaps_demog_person_age_decimaldate_latlong.csv’, ‘csp_case_children.csv’, and ‘csp_case_households.csv’ or proportional sharing and L1 norm equivalents. ama1 metrics using ama1 equivalent files.
-5A,D generated using ‘plot binary sharing function.R’ with ‘csp share score all283 case_child comp time dist.csv’ or ama1 equivalent
-5B,E generated using ‘plot proportional sharing function.R’ with ‘csp weighted share score all283 case_child comp time dist.csv’ or ama1 equivalent
-5C,F generated using ‘plot L1 norm function.R’ with ‘csp L1L2norm all283 case_child comp time dist.csv’ or ama1 equivalent

Figure 6:
-6A,B generated with ‘haplotype_presence_over_time_cc_household_difference_fisherp csp.R’ using ‘csp_haps_demog_merged_nocontrols.csv’. ama1 using ama1 equivalents
-6J generated with ‘plot outbreak map.R’ with ‘may_july_cc.csv’

Figure S4:
-S4C,D csp nucleotide diversity values generated using ‘diversity_piNS_3.RData’ workspace and ‘gen_diversity_CSP.R’ with ‘csp_haps_seqs_demog_merged.csv’. ama1 metrics with ama1 equivalent files.

Figure S5:
-Identical to description for Figure 2, using ama1 equivalent files

Figure S6:
-Identical to description for Figure 3, using ama1 equivalent files

Figure S7:
-Within household genetic similarity csp household member similarity metrics generated using ‘binary sharing all households csp.R’ with ‘allhaps_demog.csv’ and ‘csp_households.csv’. ama1 metrics with ama1 equivalent files
-Equivalent approach/files used for within village, within location, and for the entire population
-Correlation and figure panels generated using prism graphpad

Figure S8:
-Identical to description for Figure 5, using ama1 equivalent files. Plot geographic distance on x-axis rather than temporal distance. 

Table 3:
-Pairwise comparison calculations csp case child:household similarity metric matrices generated using ‘binary sharing all households case_child matrix.csp’ with ‘csp_allhaps_demog_person.csv’, ‘csp_case_households.csv’, ‘and csp_casechild_share.csv’. ama1 metrics using ama1 equivalent files
-Maximal prediction combined csp and ama1 metric. Utilize ‘binary sharing cc household prediction.R’ with matrix output of csp and ama1 pairwise comparison calculations or proportional sharing and L1 norm equivalent. 

Table S2:
-Uses same files from Figures 3 and S6. Statistical test at end of code for comparison of within-month vs between months

Table S3:
-Uses same files from Figures 3 and S6. Statistical test at end of code for comparison of within-location vs between locations
